<body>
    <script src="../../node_modules/scratch-vm/dist/web/scratch-vm.js"></script>
    <script src="../../node_modules/scratch-storage/dist/web/scratch-storage.js"></script>
    <script src="../../dist/web/scratch-render.js"></script>
    <canvas id="test" width="480" height="360"></canvas>
    <input type="file" id="file" name="file">
        <script>
            var render = new ScratchRender(document.getElementById('test'));
            var vm = new VirtualMachine();
            var storage = new ScratchStorage();
            var loaded;
            vm.attachStorage(storage);
            vm.attachRenderer(render);

            document.getElementById('file').addEventListener('click', e => {
                document.body.removeChild(document.getElementById('loaded'));
            });

            document.getElementById('file').addEventListener('change', e => {
                    const reader = new FileReader();
                    const thisFileInput = e.target;
                    reader.onload = () => {
                        vm.start();
                        vm.loadProject(reader.result)
                            .then(() => {
                                const div = document.createElement('div');
                                div.id='loaded';
                                document.body.appendChild(div);
                            });
                    };
                    reader.readAsArrayBuffer(thisFileInput.files[0]);
            });
        </script>
</body>
